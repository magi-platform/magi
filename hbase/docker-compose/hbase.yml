version: "3"
services:

  hbase-master:
    container_name: hbase-master
    hostname: hbase-master
    image: reynoldsm88/hbase-master:latest
    ports:
      - "6022:22"
      - "60000:60000"
      - "60010:60010"
      - "2889:2888"
      - "8085:8085"
    depends_on:
      - hdfs-namenode
      - hdfs-datanode
      - zookeeper
    networks:
      - magi

  hbase-regionserver:
    container_name: hbase-regionserver
    hostname: hbase-regionserver
    image: reynoldsm88/hbase-regionserver:latest
    ports:
      - "6023:22"
      - "60020:60020"
      - "60030:60030"
      - "2890:2888"
    depends_on:
      - hdfs-namenode
      - hdfs-datanode
      - hbase-master
      - zookeeper
    networks:
      - magi  

  hdfs-namenode:
    container_name: namenode
    hostname: namenode
    image: reynoldsm88/hdfs-namenode:latest
    ports:
      - "6024:22"
      - "9000:9000"
      - "50070:50070"
      - "50470:50470"
    volumes:
       - ../../data/namenode:/opt/app/data/namenode
    networks:
      - magi

  hdfs-datanode:
    container_name: datanode-1
    hostname: datanode-1
    image: reynoldsm88/hdfs-datanode:latest
    ports:
      - "6025:22"
      - "50075:50075"
      - "50475:50475"
      - "50010:50010" 
      - "50020:50020"
    volumes:
       - ../../data/datanode:/opt/app/data/datanode
    networks:
      - magi

  zookeeper:
    container_name: zookeeper
    hostname: zookeeper
    image: zookeeper:3.4.9
    ports:
      - "2181:2181"
      - "3888:3888"
      - "2888:2888"
    environment:
      ZOO_MY_ID: 1
      ZOO_PORT: 2181
      ZOO_SERVERS: server.1=zookeeper:2888:3888
    volumes:
      - ../../data/zookeeper-data:/data
      - ../../data/zookeeper-datalog:/datalog
    networks:
      - magi

networks:
  magi: